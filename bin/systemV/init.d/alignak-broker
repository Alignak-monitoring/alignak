#!/bin/sh
# Generated by sysd2v v0.3  --  http://www.trek.eu.org/devel/sysd2v
# kFreeBSD do not accept scripts as interpreters, using #!/bin/sh and sourcing.
if [ true != "$INIT_D_SCRIPT_SOURCED" ] ; then
    set "$0" "$@"; INIT_D_SCRIPT_SOURCED=true . /lib/init/init-d-script
fi
### BEGIN INIT INFO
# Provides:       alignak-broker
# Required-Start: $remote_fs
# Required-Stop:  $remote_fs
# Should-Start:   alignak
# Should-Stop:    alignak
# Default-Start:  2 3 4 5
# Default-Stop:   0 1 6
# Description:    Alignak broker INSTANCE_NAME daemon instance
### END INIT INFO
set -a
ALIGNAK_CONFIGURATION_FILE=/usr/local/share/alignak/etc/alignak.ini
ALIGNAK_USER=alignak
ALIGNAK_GROUP=alignak
[ -r /etc/default/alignak ] && . /etc/default/alignak
set +a

DAEMON=/usr/local/bin/alignak-broker
DAEMON_ARGS=\"-d -n broker-INSTANCE_NAME -e "${ALIGNAK_CONFIGURATION_FILE}" --pid_file /var/run/alignak/broker-INSTANCE_NAME.pid --log_file /var/log/alignak/broker-INSTANCE_NAME.log\"
PIDFILE=/var/run/alignak/broker-INSTANCE_NAME.pid
STOP_ARGS=\"--retry=TERM/30/KILL/5\"

do_start_cmd_override ()
{
  /bin/mkdir -p /var/log/alignak || return 2
  /bin/chown -R ${ALIGNAK_USER}:${ALIGNAK_GROUP} /var/log/alignak || return 2
  /bin/chmod 775 /var/log/alignak || return 2
  /bin/mkdir -p /var/run/alignak || return 2
  /bin/chown -R ${ALIGNAK_USER}:${ALIGNAK_GROUP} /var/run/alignak || return 2
  /bin/chmod 775 /var/run/alignak || return 2
  /bin/echo Alignak starting broker INSTANCE_NAME - /usr/local/bin/alignak-broker -d -n broker-INSTANCE_NAME -e "${ALIGNAK_CONFIGURATION_FILE}" || return 2
  do_start_cmd || return $?
}

alias do_reload=do_reload_sigusr1

